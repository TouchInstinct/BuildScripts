repositories {
    maven { url "http://dl.bintray.com/touchin/touchin-tools" }
}

configurations {
    apigenerator
}

dependencies {
    apigenerator 'ru.touchin:api-generator:1.3'
}

task apiGeneratorKotlinServer doLast {
    def jarArgs = new ArrayList<String>()
    jarArgs.add(configurations.apigenerator.asPath)
    jarArgs.add("generate-client-code")
    jarArgs.add("--output-language")
    jarArgs.add("KOTLIN_SERVER")
    jarArgs.add("--specification-path")
    jarArgs.add(rootProject.extensions.findByName("pathToApiSchemes"))
    jarArgs.add("--output-path")
    jarArgs.add("${rootDir}/src/main/generated")
    jarArgs.add("--package-name")
    jarArgs.add(rootProject.extensions.findByName("apiPackageName"))
    javaexec { main = "-jar"; args = jarArgs; workingDir = file("${rootDir}") }
}

